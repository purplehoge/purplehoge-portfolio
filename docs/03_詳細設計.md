# 詳細設計書

## クラス・モジュール単位の責務

### HTML構造設計

#### メインページ (index.html)
```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <!-- メタ情報、CSS読み込み -->
</head>
<body>
    <header class="header">
        <nav class="header__nav">
            <!-- ナビゲーション -->
        </nav>
    </header>
    
    <main class="main">
        <section class="hero">
            <!-- ヒーローセクション -->
        </section>
        
        <section class="about">
            <!-- 自己紹介セクション -->
        </section>
        
        <section class="skills">
            <!-- スキルセクション -->
        </section>
        
        <section class="projects">
            <!-- プロジェクトセクション -->
        </section>
    </main>
    
    <footer class="footer">
        <!-- フッター -->
    </footer>
</body>
</html>
```

### CSS設計詳細

#### styles.css の責務
- **目的**: メインスタイルとレイアウトの定義
- **入力**: HTMLセレクタ
- **出力**: 視覚的スタイル

```css
/* CSS変数定義 */
:root {
    --primary-color: #2c3e50;
    --secondary-color: #3498db;
    --accent-color: #e74c3c;
    --text-color: #333;
    --bg-color: #f8f9fa;
    --white: #ffffff;
    
    --font-main: 'Helvetica Neue', Arial, sans-serif;
    --font-code: 'Monaco', 'Consolas', monospace;
    
    --spacing-xs: 0.5rem;
    --spacing-sm: 1rem;
    --spacing-md: 2rem;
    --spacing-lg: 3rem;
    --spacing-xl: 4rem;
}
```

#### responsive.css の責務
- **目的**: デバイス別レスポンシブ対応
- **入力**: メディアクエリブレイクポイント
- **出力**: デバイス最適化スタイル

### JavaScript設計詳細

#### main.js の責務
```javascript
/**
 * メインアプリケーションクラス
 * サイト全体の初期化と制御を担当
 */
class PortfolioApp {
    constructor() {
        this.skillsData = [];
        this.projectsData = [];
        this.init();
    }
    
    /**
     * アプリケーション初期化
     * DOM読み込み完了後に実行される
     */
    init() {
        this.loadSkillsData();
        this.loadProjectsData();
        this.setupEventListeners();
        this.initializeAnimations();
    }
    
    /**
     * スキルデータの読み込み
     * @returns {void}
     */
    loadSkillsData() {
        // スキルデータの定義と読み込み処理
    }
    
    /**
     * プロジェクトデータの読み込み  
     * @returns {void}
     */
    loadProjectsData() {
        // プロジェクトデータの定義と読み込み処理
    }
    
    /**
     * イベントリスナーの設定
     * @returns {void}
     */
    setupEventListeners() {
        // スムーズスクロール、レスポンシブメニュー等
    }
    
    /**
     * アニメーション初期化
     * @returns {void}
     */
    initializeAnimations() {
        // スクロール連動アニメーション等
    }
}
```

#### utils.js の責務
```javascript
/**
 * ユーティリティ関数集
 * 汎用的な処理を提供
 */

/**
 * DOM要素を安全に選択
 * @param {string} selector - CSSセレクター
 * @returns {Element|null} 見つかった要素またはnull
 */
const safeQuerySelector = (selector) => {
    try {
        return document.querySelector(selector);
    } catch (error) {
        console.warn(`Invalid selector: ${selector}`, error);
        return null;
    }
};

/**
 * 画像の遅延読み込み
 * @param {string} imageSrc - 画像のソースURL
 * @param {Element} targetElement - 対象のDOM要素
 * @returns {Promise<void>}
 */
const lazyLoadImage = async (imageSrc, targetElement) => {
    try {
        const img = new Image();
        img.onload = () => {
            targetElement.src = imageSrc;
            targetElement.classList.add('loaded');
        };
        img.onerror = () => {
            targetElement.src = 'images/placeholder.svg';
            targetElement.classList.add('error');
        };
        img.src = imageSrc;
    } catch (error) {
        console.error('Image loading failed:', error);
    }
};

/**
 * スムーズスクロール
 * @param {string} targetId - スクロール先のID
 * @returns {void}
 */
const smoothScrollTo = (targetId) => {
    const target = safeQuerySelector(`#${targetId}`);
    if (target) {
        target.scrollIntoView({ 
            behavior: 'smooth',
            block: 'start' 
        });
    }
};
```

## 入出力・例外・前後条件

### スキルセクション
- **入力**: skillsData配列
- **出力**: スキル一覧のHTML生成
- **例外処理**: データが空の場合のフォールバック表示
- **前提条件**: DOM読み込み完了
- **後続条件**: レスポンシブ対応完了

### プロジェクトセクション  
- **入力**: projectsData配列
- **出力**: プロジェクトカード群のHTML生成
- **例外処理**: 画像読み込み失敗時のプレースホルダー表示
- **前提条件**: 画像ファイルの配置完了
- **後続条件**: 遅延読み込み設定完了

## データ構造とアルゴリズム

### スキルデータ構造
```javascript
const skillsData = [
    {
        category: "Frontend",
        skills: [
            {
                name: "HTML5",
                level: "advanced",
                icon: "html5-icon.svg",
                description: "セマンティックマークアップ、アクセシビリティ対応"
            },
            {
                name: "CSS3",
                level: "advanced", 
                icon: "css3-icon.svg",
                description: "レスポンシブ、Grid、Flexbox、アニメーション"
            },
            {
                name: "JavaScript",
                level: "intermediate",
                icon: "javascript-icon.svg", 
                description: "ES6+、DOM操作、非同期処理"
            }
        ]
    }
];
```

### プロジェクトデータ構造
```javascript
const projectsData = [
    {
        id: "project-001",
        title: "サンプルプロジェクト",
        description: "プロジェクトの概要説明文。使用した技術や解決した課題について記述。",
        technologies: ["HTML", "CSS", "JavaScript"],
        image: "images/projects/project-001.jpg",
        demoUrl: null,
        sourceUrl: null,
        status: "completed", // completed, in-progress, planned
        featured: true       // 注目プロジェクトかどうか
    }
];
```

### レンダリングアルゴリズム

#### スキル表示アルゴリズム
```javascript
/**
 * スキルセクションのレンダリング
 * カテゴリ別にグループ化してHTMLを生成
 */
renderSkills() {
    const skillsContainer = safeQuerySelector('.skills__content');
    if (!skillsContainer) return;
    
    let html = '';
    
    // カテゴリ別にスキルをグループ化
    this.skillsData.forEach(category => {
        html += `
            <div class="skills__category">
                <h3 class="skills__category-title">${category.category}</h3>
                <div class="skills__list">
                    ${category.skills.map(skill => `
                        <div class="skill-card skill-card--${skill.level}">
                            <div class="skill-card__icon">
                                <img src="images/icons/${skill.icon}" 
                                     alt="${skill.name}" 
                                     loading="lazy">
                            </div>
                            <div class="skill-card__content">
                                <h4 class="skill-card__name">${skill.name}</h4>
                                <p class="skill-card__description">${skill.description}</p>
                                <span class="skill-card__level skill-card__level--${skill.level}">
                                    ${this.getLevelText(skill.level)}
                                </span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    });
    
    skillsContainer.innerHTML = html;
}
```

## 設定値・環境依存の扱い

### CSS変数による設定管理
```css
:root {
    /* カラーテーマ */
    --color-primary: #2c3e50;
    --color-secondary: #3498db;
    --color-success: #27ae60;
    --color-warning: #f39c12;
    --color-danger: #e74c3c;
    
    /* レスポンシブブレイクポイント */
    --breakpoint-sm: 576px;
    --breakpoint-md: 768px;
    --breakpoint-lg: 992px;
    --breakpoint-xl: 1200px;
    
    /* アニメーション設定 */
    --animation-duration: 0.3s;
    --animation-timing: ease-in-out;
}
```

### JavaScript設定オブジェクト
```javascript
const CONFIG = {
    // パフォーマンス設定
    LAZY_LOAD_THRESHOLD: '100px',
    ANIMATION_DELAY: 100,
    
    // UI設定
    SMOOTH_SCROLL_DURATION: 800,
    MOBILE_MENU_BREAKPOINT: 768,
    
    // 画像設定
    PLACEHOLDER_IMAGE: 'images/placeholder.svg',
    DEFAULT_PROJECT_IMAGE: 'images/default-project.jpg',
    
    // メッセージ
    MESSAGES: {
        LOADING: '読み込み中...',
        ERROR: 'エラーが発生しました',
        NO_PROJECTS: 'プロジェクトがありません'
    }
};
```

## テスト観点

### ユニットテスト観点

#### JavaScript関数テスト
- **safeQuerySelector**: 正常セレクタ、不正セレクタ、null要素
- **lazyLoadImage**: 正常画像、存在しない画像、ネットワークエラー
- **smoothScrollTo**: 存在するID、存在しないID、空文字

#### CSS表示テスト
- **レスポンシブ**: 各ブレイクポイントでの表示確認
- **カラーコントラスト**: アクセシビリティ基準の確認
- **フォント**: フォールバックフォントの確認

### 結合テスト観点

#### ページ表示テスト
- **初期読み込み**: 全セクションの正常表示
- **ナビゲーション**: 各セクションへのスムーズスクロール
- **レスポンシブメニュー**: モバイルでのメニュー開閉

#### データ表示テスト
- **スキル表示**: カテゴリ別グループ化、レベル表示
- **プロジェクト表示**: カード形式、画像遅延読み込み
- **空データ**: データが空の場合の表示

### E2Eテスト観点

#### ユーザーシナリオテスト
1. **初回訪問**: サイト読み込み → 各セクション閲覧 → スクロール操作
2. **モバイル閲覧**: スマートフォンでアクセス → メニュー操作 → 縦スクロール
3. **パフォーマンス**: 3秒以内の初期読み込み完了

#### ブラウザ互換性テスト
- **Chrome**: 最新版 + 1つ前のバージョン
- **Firefox**: 最新版
- **Safari**: 最新版（Mac/iOS）
- **Edge**: 最新版

### 品質確認チェックリスト

#### 技術的品質
- [ ] HTML5バリデーション通過
- [ ] CSS構文エラーなし  
- [ ] JavaScript構文エラーなし
- [ ] Console警告・エラーなし
- [ ] パフォーマンススコア80以上

#### アクセシビリティ品質
- [ ] altテキスト適切設定
- [ ] キーボード操作可能
- [ ] 色彩コントラスト比4.5:1以上
- [ ] セマンティックHTML使用

#### UX品質
- [ ] 3秒以内の初期読み込み
- [ ] スムーズなスクロール動作
- [ ] 直感的なナビゲーション
- [ ] 一貫したデザイン言語

---

## 実装優先度

### Phase 1: 基本実装
1. HTML基本構造
2. CSS基本スタイル
3. レスポンシブ対応
4. 基本的なJavaScript

### Phase 2: 機能強化
1. アニメーション追加
2. 画像最適化
3. パフォーマンスチューニング
4. アクセシビリティ向上

### Phase 3: 品質向上
1. テスト実施
2. ブラウザ互換性確認
3. SEO最適化
4. 最終品質チェック